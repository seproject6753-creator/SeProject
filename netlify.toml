# Netlify build configuration for the React frontend
# Docs: https://docs.netlify.com/configure-builds/file-based-configuration/

[build]
  # Build from repo root but execute npm in the frontend subfolder
  command = "npm --prefix frontend ci && npm --prefix frontend run build"
  publish = "frontend/build"

[build.environment]
  # Ensure a modern Node version compatible with react-scripts 5
  NODE_VERSION = "18"
  # Extra heap to reduce OOM on larger builds
  NODE_OPTIONS = "--max_old_space_size=4096"
  # Prevent CRA from failing on warnings in CI
  CI = "false"
  
  # Set these in the Netlify UI (recommended) or uncomment and commit a fork
  # REACT_APP_APILINK = "https://<your-render-app>.onrender.com/api"
  # REACT_APP_MEDIA_LINK = "https://<your-render-app>.onrender.com/media"
